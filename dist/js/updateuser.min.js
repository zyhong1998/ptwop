$(function(){!function(){if(!localStorage.getItem("uid")||!localStorage.getItem("username"))alert("请先登录！！！"),location.href="/login.html"}();function e(t,e){t.css("border","1px solid red").siblings(".error").text(e).css("color","red")}function i(t){t.css("border","1px solid green").siblings(".error").text("")}$("#nickname").blur(function(){var t=$(this).val();t?/^[a-zA-Z]\w{2,11}$/.test(t)?i($(this)):e($(this),"请输入合法昵称"):e($(this),"请输入昵称")}),$("#email").blur(function(){var t=$(this).val();t?/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/.test(t)?i($(this)):e($(this),"请输入合法邮箱"):e($(this),"请输入邮箱")}),$("#phone").blur(function(){var t=$(this).val();t?/\d{11}/.test(t)?i($(this)):e($(this),"请输入合法电话"):e($(this),"请输入电话")}),$("#saveBtn").click(function(){var t=$("#nickname").val(),e=$("#email").val(),i=$("#phone").val(),a=localStorage.getItem("uid");$.ajax({url:"http://127.0.0.1:8848/updateuser.php",type:"POST",data:{id:a,nickname:t,email:e,phone:i},success:function(t){"ok"==t?(alert("保存成功"),location.href="#personal/getuserinfo"):alert("保存失败，请稍后重试")}})})});